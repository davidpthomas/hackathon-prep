<!DOCTYPE html>
<html>
<head>
    <title>hackathon-prep</title>

    <script type="text/javascript" src="/apps/2.0/sdk.js"></script>
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.3.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>

    <script type="text/javascript">
        Rally.onReady(function () {
                Ext.define("CustomApp",{extend:"Rally.app.App",componentCls:"app",items:[{xtype:"container",html:"<button>Update</button>"}],listeners:{afterrender:function(){this.buildChart()}},launch:function(){},buildChart:function(){function randomize(d){return d.randomizer||(d.randomizer=randomizer(d)),d.ranges=d.ranges.map(d.randomizer),d.markers=d.markers.map(d.randomizer),d.measures=d.measures.map(d.randomizer),d}function randomizer(d){var k=.2*d3.max(d.ranges);return function(d){return Math.max(0,d+k*(Math.random()-.5))}}var margin={top:5,right:40,bottom:20,left:120},width=960-margin.left-margin.right,height=50-margin.top-margin.bottom,chart=d3.bullet().width(width).height(height);d3.json("bullets.json",function(error,data){if(console.log("got data",data),error)throw error;var svg=d3.select("body").selectAll("svg").data(data).enter().append("svg").attr("class","bullet").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g").attr("transform","translate("+margin.left+","+margin.top+")").call(chart),title=svg.append("g").style("text-anchor","end").attr("transform","translate(-6,"+height/2+")");title.append("text").attr("class","title").text(function(d){return d.title}),title.append("text").attr("class","subtitle").attr("dy","1em").text(function(d){return d.subtitle})})}});
                (function(){function bulletRanges(d){return d.ranges}function bulletMarkers(d){return d.markers}function bulletMeasures(d){return d.measures}function bulletTranslate(x){return function(d){return"translate("+x(d)+",0)"}}function bulletWidth(x){var x0=x(0);return function(d){return Math.abs(x(d)-x0)}}d3.bullet=function(){function bullet(g){g.each(function(d,i){var rangez=ranges.call(this,d,i).slice().sort(d3.descending),markerz=markers.call(this,d,i).slice().sort(d3.descending),measurez=measures.call(this,d,i).slice().sort(d3.descending),g=d3.select(this),x1=d3.scale.linear().domain([0,Math.max(rangez[0],markerz[0],measurez[0])]).range(reverse?[width,0]:[0,width]),x0=this.__chart__||d3.scale.linear().domain([0,1/0]).range(x1.range());this.__chart__=x1;var w0=bulletWidth(x0),w1=bulletWidth(x1),range=g.selectAll("rect.range").data(rangez);range.enter().append("rect").attr("class",function(d,i){return"range s"+i}).attr("width",w0).attr("height",height).attr("x",reverse?x0:0).transition().duration(duration).attr("width",w1).attr("x",reverse?x1:0),range.transition().duration(duration).attr("x",reverse?x1:0).attr("width",w1).attr("height",height);var measure=g.selectAll("rect.measure").data(measurez);measure.enter().append("rect").attr("class",function(d,i){return"measure s"+i}).attr("width",w0).attr("height",height/3).attr("x",reverse?x0:0).attr("y",height/3).transition().duration(duration).attr("width",w1).attr("x",reverse?x1:0),measure.transition().duration(duration).attr("width",w1).attr("height",height/3).attr("x",reverse?x1:0).attr("y",height/3);var marker=g.selectAll("line.marker").data(markerz);marker.enter().append("line").attr("class","marker").attr("x1",x0).attr("x2",x0).attr("y1",height/6).attr("y2",5*height/6).transition().duration(duration).attr("x1",x1).attr("x2",x1),marker.transition().duration(duration).attr("x1",x1).attr("x2",x1).attr("y1",height/6).attr("y2",5*height/6);var format=tickFormat||x1.tickFormat(8),tick=g.selectAll("g.tick").data(x1.ticks(8),function(d){return this.textContent||format(d)}),tickEnter=tick.enter().append("g").attr("class","tick").attr("transform",bulletTranslate(x0)).style("opacity",1e-6);tickEnter.append("line").attr("y1",height).attr("y2",7*height/6),tickEnter.append("text").attr("text-anchor","middle").attr("dy","1em").attr("y",7*height/6).text(format),tickEnter.transition().duration(duration).attr("transform",bulletTranslate(x1)).style("opacity",1);var tickUpdate=tick.transition().duration(duration).attr("transform",bulletTranslate(x1)).style("opacity",1);tickUpdate.select("line").attr("y1",height).attr("y2",7*height/6),tickUpdate.select("text").attr("y",7*height/6),tick.exit().transition().duration(duration).attr("transform",bulletTranslate(x1)).style("opacity",1e-6).remove()}),d3.timer.flush()}var orient="left",reverse=!1,duration=0,ranges=bulletRanges,markers=bulletMarkers,measures=bulletMeasures,width=380,height=30,tickFormat=null;return bullet.orient=function(x){return arguments.length?(orient=x,reverse="right"==orient||"bottom"==orient,bullet):orient},bullet.ranges=function(x){return arguments.length?(ranges=x,bullet):ranges},bullet.markers=function(x){return arguments.length?(markers=x,bullet):markers},bullet.measures=function(x){return arguments.length?(measures=x,bullet):measures},bullet.width=function(x){return arguments.length?(width=x,bullet):width},bullet.height=function(x){return arguments.length?(height=x,bullet):height},bullet.tickFormat=function(x){return arguments.length?(tickFormat=x,bullet):tickFormat},bullet.duration=function(x){return arguments.length?(duration=x,bullet):duration},bullet}})();

            Rally.launchApp('CustomApp', {
                name:"hackathon-prep",
	            parentRepos:""
            });

        });
    </script>


    <style type="text/css">
        body{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif;margin:auto;padding-top:40px;position:relative;width:960px}button{position:absolute;right:10px;top:10px}.bullet{font:10px sans-serif}.bullet .marker{stroke:#000;stroke-width:2px}.bullet .tick line{stroke:#666;stroke-width:.5px}.bullet .range.s0{fill:#eee}.bullet .range.s1{fill:#ddd}.bullet .range.s2{fill:#ccc}.bullet .measure.s0{fill:lightsteelblue}.bullet .measure.s1{fill:steelblue}.bullet .title{font-size:14px;font-weight:bold}.bullet .subtitle{fill:#999}
    </style>
</head>
<body>
</body>
</html>
